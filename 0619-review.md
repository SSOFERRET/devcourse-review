# :fire: 

## 인수테스트 자동화

### 인수 테스트 (UAT: User Acceptance Test)

- 요구사항대로 기능이 구현되었는지를 확인하는 과정
  - 전체 시스템을 사용자 관점에서 시험하는 블랙박스 테스트를 포함
- 이것들을 자동화하는 것은 쉽지 않은 일이지만 CI/CD의 구축을 위해 반드시 필요
- 사용자 인수 테스트를 자동화하는 것이 어려운 요인들
  - 사용자 참여: 기술적 측변과 비기술적 측면에 대한 요구사항의 최종 확인은 실사용자여야 함.
  - 의존성 통합: 테스트할 애플리케이션은 모든 의존성을 포함하여 실행되어야 함
  - 스테이징 환경: 프로덕션 환경과 동일한 스테이징 환경에서 이루어져야 함
  - 애플리케이션 동일성: 한 번만 빌드하여 프로덕션에서와 동일한 바이너리를 이용해야 함
  - 틸리스 준비: 인수 테스트를 통과한 애플리케이션은 즉시 릴리스 준비가 되어야 함

### 이미지 레지스트리 구성

- 도커 레지스트리의 구성
- 애플리케이션 패키지 빌드 및 이미지 푸시
- UAT 프레임워크 적용

#### 아티팩트 리포지토리

- 버전 관리, 접근 제어 등의 기능을 가지는 소프트웨어 개발 산출물을 발행하거나 인출할 수 있는 저장소 및 관리 기법이 필요
- 파이프라인의 모든 단계에서 동일한 바이너리가 사용되는 것을 보장함으로써 지속적 인도 프로레스에서 매우 중요한 역할을 함.

#### 도커 레지스트리

- 컨테이너화된 소프트웨어의 산출물인 도커 이미지를 관리할 수 있는 리포지토리
- 클라우드 방식 레지스트리
  - Docker Hub
  - 상용 클라우드에서 제공하는 서비스
- 자체 호스팅 방식 레지스트리
  - 사내 네트워크가 아닌 외부에 소프트웨어를 보관하는 것을 금지하는 정책을 갖고 있는 경우에 유일한 해결 방법
  - 직접 관리해야하는 부담이 있고 접근 제어 및 인증서 설정 등의 번거로운 작업이 수반

#### 이미지 레지스트리 구축

- Docker를 이용해서 로컬 컴퓨터의 컨테이너로 레지스트리 서비스 테스트
- k8s 클러스터에 레지스트리 서비스 배포
  - 기본적 동작을 테스트
  - OpenSSL 인증서 설치, 설정
  - PV와 PVC를 만들어 레지스트리 데이터가 호스트에 남아있도록 설정
  - docker push와 kubectl run 으로 기본적 확인

---

## Jenkins 파이프라인에서의 인수 테스트

![image](https://github.com/SSOFERRET/devcourse-review/assets/148465774/0e5334f3-d7de-4be5-a587-e801c7fc4032)

- 개발자가 변경한 코드를 GitHub에 푸시
- Jenkins가 변경을 감지하고 코드를 인출해 빌드를 시작, 코드를 점검(단위테스트 수행)
- Jenkins가 빌드를 완료하여 도커 이미지를 생성
- Jenkins가 생성한 이미지를 레지스트리로 푸시
- Jenkins가 스테이징 환경을 구성하고 도커 컨테이너 실행
- 스테이징 환경의 도커 호스트가 이미지를 가져다가 컨테이너를 실행
- Jenkins가 스테이징 환경에서 실행 중인 애플리케이션을 대상으로 인수 테스트를 실행
